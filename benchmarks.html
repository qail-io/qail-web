<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Benchmarks | QAIL</title>
    <meta name="description" content="QAIL-PG: The fastest Rust PostgreSQL driver. 172x faster with query pipelining.">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- Social Meta Tags -->
    <meta property="og:title" content="QAIL Benchmarks - 172x Faster">
    <meta property="og:description"
        content="Query pipelining delivers 172x speedup. 1 million queries in 3.6 minutes instead of 10 hours.">
    <meta property="og:image" content="https://qail-web.pages.dev/social_preview.svg">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        .big-number {
            font-size: 8rem;
            font-weight: 900;
            background: linear-gradient(135deg, #22c55e, #06b6d4);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            margin: 2rem 0;
        }

        .big-number span {
            font-size: 4rem;
        }

        .benchmark-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            font-family: 'JetBrains Mono', monospace;
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 8px;
            overflow: hidden;
        }

        .benchmark-table th,
        .benchmark-table td {
            padding: 1rem;
            text-align: right;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .benchmark-table th {
            background: var(--surface-2);
            color: var(--text-muted);
            font-weight: 600;
        }

        .benchmark-table td:first-child {
            text-align: left;
            color: var(--text);
        }

        .benchmark-table .winner {
            color: var(--accent);
            font-weight: bold;
        }

        .benchmark-table .loser {
            color: var(--text-muted);
        }

        .speedup-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            color: var(--bg);
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 0.875rem;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .comparison-card {
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
        }

        .comparison-card h3 {
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }

        .comparison-card .time {
            font-size: 2rem;
            font-weight: bold;
            font-family: 'JetBrains Mono', monospace;
        }

        .comparison-card.qail .time {
            color: var(--accent);
        }

        .comparison-card.serial .time {
            color: #ef4444;
        }

        .code-example {
            background: var(--surface-2);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 2rem 0;
            overflow-x: auto;
            border: 1px solid var(--border);
        }

        .code-example pre {
            margin: 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--text);
        }

        .roadmap-list {
            text-align: left;
            max-width: 500px;
            margin: 2rem auto;
            list-style: none;
            padding: 0;
        }

        .roadmap-list li {
            padding: 0.75rem 0;
            color: var(--text);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .roadmap-list li::before {
            content: "‚Üí";
            color: var(--primary);
        }

        .disclaimer {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-top: 2rem;
            padding: 1rem;
            background: var(--surface-2);
            border-radius: 0.5rem;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <div id="navbar"></div>

    <header class="page-header" style="text-align: center;">
        <div class="container">
            <h1>Performance Benchmarks</h1>
            <p class="subtitle">Query Pipelining: A New Way to Talk to Databases</p>

            <div class="big-number">172<span>x</span></div>
            <p style="color: var(--text-muted); font-size: 1.25rem;">Faster than one-at-a-time queries</p>
        </div>
    </header>

    <main class="page-content">
        <div class="container">

            <section style="margin-bottom: 3rem;">
                <h2 style="color: var(--primary); font-size: 1.75rem; margin-bottom: 1.5rem; text-align: center;">üöÄ
                    Query Pipelining</h2>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 2rem;">
                    Send multiple queries in one network round-trip instead of waiting after each one.<br>
                    <em>This compares <strong>usage patterns</strong>, not drivers. Any driver could pipeline with
                        enough work.</em>
                </p>

                <div class="comparison-grid">
                    <div class="comparison-card serial">
                        <h3>One-at-a-time (Standard Pattern)</h3>
                        <div class="time">10.3 hours</div>
                        <p style="color: var(--text-muted);">1M queries √ó 1 await each = 1M round-trips</p>
                    </div>
                    <div class="comparison-card qail">
                        <h3>QAIL Pipelining</h3>
                        <div class="time">3.6 minutes</div>
                        <p style="color: var(--text-muted);">1M queries √∑ 1000 batches = 1K round-trips</p>
                    </div>
                </div>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Queries</th>
                            <th>One-at-a-time</th>
                            <th>Pipelined</th>
                            <th>Speedup</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>100</td>
                            <td class="loser">3.7s</td>
                            <td class="winner">733ms</td>
                            <td><span class="speedup-badge">5.1x</span></td>
                        </tr>
                        <tr>
                            <td>1,000</td>
                            <td class="loser">37s</td>
                            <td class="winner">862ms</td>
                            <td><span class="speedup-badge">43x</span></td>
                        </tr>
                        <tr>
                            <td>1,000,000</td>
                            <td class="loser">10.3 hours</td>
                            <td class="winner">215s</td>
                            <td><span class="speedup-badge">172x</span></td>
                        </tr>
                    </tbody>
                </table>

                <div class="code-example"
                    style="background: #1e1e2e; border-radius: 12px; padding: 1.5rem; text-align: left;">
                    <pre style="margin: 0; color: #e2e8f0; line-height: 1.6;"><code><span style="color: #6a9955;">// Send 1000 queries in ONE network round-trip!</span>
<span style="color: #569cd6;">let</span> results = conn.<span style="color: #dcdcaa;">query_pipeline</span>(&amp;[
    (<span style="color: #ce9178;">"SELECT * FROM users WHERE id = $1"</span>, &amp;params1),
    (<span style="color: #ce9178;">"SELECT * FROM orders WHERE user_id = $1"</span>, &amp;params2),
    <span style="color: #6a9955;">// ... 998 more queries</span>
]).<span style="color: #569cd6;">await</span>?;

<span style="color: #6a9955;">// All 1000 queries executed in ~100ms instead of 37 seconds!</span></code></pre>
                </div>
            </section>

            <section style="margin-bottom: 3rem;">
                <h2 style="color: var(--primary); font-size: 1.75rem; margin-bottom: 1.5rem; text-align: center;">‚ö°
                    Single Query Performance</h2>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 2rem;">
                    For single queries, QAIL matches SQLx and crushes ORMs.
                </p>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Driver</th>
                            <th>Connect</th>
                            <th>COUNT(*)</th>
                            <th>Fetch 20</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>QAIL-PG</td>
                            <td class="winner">158ms</td>
                            <td>3,714ms</td>
                            <td>3,768ms</td>
                        </tr>
                        <tr>
                            <td>SQLx</td>
                            <td class="loser">190ms</td>
                            <td>3,712ms</td>
                            <td>3,768ms</td>
                        </tr>
                        <tr>
                            <td>SeaORM</td>
                            <td class="loser">225ms</td>
                            <td class="loser">10,938ms</td>
                            <td class="loser">11,250ms</td>
                        </tr>
                    </tbody>
                </table>

                <p class="disclaimer">
                    <strong>‚ö†Ô∏è Honest note:</strong> SQLx, Diesel, and other drivers <em>could</em> pipeline queries
                    with raw protocol access.
                    We're not claiming QAIL is fundamentally faster‚Äîwe're showing that <code>query_pipeline()</code>
                    makes
                    batching <strong>easy and ergonomic</strong>. The 172x speedup is real, but it's comparing
                    usage patterns (one-at-a-time vs batched), not driver implementations.
                </p>

                <p class="disclaimer">
                    <strong>Single query benchmark:</strong> 100 iterations against real PostgreSQL via
                    SSH tunnel (~37ms RTT).
                    Single connection for all drivers. QAIL and SQLx are <strong>equally fast</strong> for single
                    queries.
                </p>
            </section>

            <section style="margin-bottom: 3rem;">
                <h2 style="color: var(--primary); font-size: 1.75rem; margin-bottom: 1.5rem; text-align: center;">üåç
                    Cross-Language Benchmark</h2>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 2rem;">
                    Fair comparison: Same prepared statements, same pipelining, same PostgreSQL, same machine.<br>
                    <em>QAIL <strong>BEATS C libpq</strong> ‚Äî the fastest driver ever benchmarked!</em>
                </p>

                <h3 style="color: var(--text); margin: 2rem 0 1rem; text-align: center;">50 Million Query Stress Test
                </h3>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Driver</th>
                            <th>Language</th>
                            <th>Q/s</th>
                            <th>vs QAIL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>QAIL</strong></td>
                            <td>Rust ü•á</td>
                            <td class="winner">353,638</td>
                            <td><span class="speedup-badge">1.00x</span></td>
                        </tr>
                        <tr>
                            <td><strong>libpq</strong></td>
                            <td>C ü•à</td>
                            <td>339,649</td>
                            <td><span class="speedup-badge">0.97x</span></td>
                        </tr>
                        <tr>
                            <td><strong>pgx</strong></td>
                            <td>Go ü•â</td>
                            <td>303,844</td>
                            <td><span class="speedup-badge">0.89x</span></td>
                        </tr>
                    </tbody>
                </table>

                <div
                    style="background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); border-radius: 12px; padding: 1.5rem; margin: 2rem 0; text-align: center;">
                    <h3 style="color: #fff; margin: 0 0 1rem;">ü¶Ä QAIL's Position</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; color: #e2e8f0;">
                        <div>
                            <div style="font-size: 1.5rem;">4% faster than C</div>
                            <div style="font-size: 0.875rem; opacity: 0.8;">353k vs 339k q/s</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem;">12% ahead of Go</div>
                            <div style="font-size: 0.875rem; opacity: 0.8;">pgx 303k q/s</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem;">16x faster Python</div>
                            <div style="font-size: 0.875rem; opacity: 0.8;">asyncpg ~21k q/s</div>
                        </div>
                    </div>
                </div>

                <p class="disclaimer">
                    <strong>Key insight:</strong> QAIL beats C libpq through zero-allocation encoding and direct integer
                    writes.
                    Rust's ownership model enables optimizations that C cannot safely express.
                </p>

                <!-- Second Benchmark: With Result Consumption -->
                <h3 style="color: var(--text); margin: 2rem 0 1rem; text-align: center;">10 Million Query - WITH Result
                    Consumption</h3>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 1rem;">
                    <em>Actually reading and parsing all row data (id, name columns)</em>
                </p>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Driver</th>
                            <th>Language</th>
                            <th>Q/s</th>
                            <th>vs QAIL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>QAIL</strong></td>
                            <td>Rust ü•á</td>
                            <td class="winner">334,139</td>
                            <td><span class="speedup-badge">1.00x</span></td>
                        </tr>
                        <tr>
                            <td><strong>libpq</strong></td>
                            <td>C ü•à</td>
                            <td>333,392</td>
                            <td><span class="speedup-badge">0.998x</span></td>
                        </tr>
                    </tbody>
                </table>

                <div
                    style="background: linear-gradient(135deg, #2d5a40 0%, #1e3a2f 100%); border-radius: 12px; padding: 1.5rem; margin: 2rem 0; text-align: center;">
                    <h3 style="color: #fff; margin: 0 0 0.5rem;">üéâ QAIL Beats C Even With Result Consumption!</h3>
                    <p style="color: #e2e8f0; margin: 0; font-size: 1.1rem;">
                        334k vs 333k q/s ‚Äî Zero-copy <code>Bytes</code> API matches C's pointer semantics
                    </p>
                </div>

                <p class="disclaimer" style="margin-top: 0.5rem;">
                    <strong>Powered by:</strong> <a href="https://tokio.rs" target="_blank"
                        style="color: var(--primary);">Tokio</a> async runtime (Layer 3 I/O).
                    Thanks to the Tokio team for the incredible async foundation! üôè
                </p>

                <!-- Third Benchmark: Pool & Scalability -->
                <h3 style="color: var(--text); margin: 2rem 0 1rem; text-align: center;">Connection Pool Throughput</h3>
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 1rem;">
                    <em>10 concurrent workers ‚Ä¢ 10 connections ‚Ä¢ 150M queries</em>
                </p>

                <table class="benchmark-table">
                    <thead>
                        <tr>
                            <th>Driver</th>
                            <th>Setup</th>
                            <th>Q/s</th>
                            <th>vs QAIL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>QAIL</strong></td>
                            <td>Tokio Async Pool ü•á</td>
                            <td class="winner">1,250,000</td>
                            <td><span class="speedup-badge">1.00x</span></td>
                        </tr>
                        <tr>
                            <td><strong>libpq</strong></td>
                            <td>C Pthreads + Pipeline ü•à</td>
                            <td>981,917</td>
                            <td><span class="speedup-badge">0.78x</span></td>
                        </tr>
                        <tr>
                            <td><strong>pgx</strong></td>
                            <td>Go Pool + Batch ü•â</td>
                            <td>652,340</td>
                            <td><span class="speedup-badge">0.52x</span></td>
                        </tr>
                    </tbody>
                </table>

                <div
                    style="background: var(--surface-2); border-left: 4px solid #f59e0b; border-radius: 4px; padding: 1rem; margin: 2rem 0; text-align: left;">
                    <h4 style="color: #f59e0b; margin: 0 0 0.5rem;">‚öñÔ∏è Fair Benchmark Parameters</h4>
                    <ul style="margin: 0; padding-left: 1.2rem; opacity: 0.9; font-size: 0.95rem;">
                        <li style="margin-bottom: 0.5rem;"><strong>Same Pool Size:</strong> 10 connections max for all
                            drivers.</li>
                        <li style="margin-bottom: 0.5rem;"><strong>Same Workers:</strong> 10 concurrent workers
                            competing for pool.</li>
                        <li style="margin-bottom: 0.5rem;"><strong>Same Batching:</strong> 100 queries per batch (QAIL
                            pipeline, Go pgx.Batch, C pthreads+pipeline).</li>
                        <li style="margin-bottom: 0.5rem;"><strong>Same Query:</strong>
                            <code>SELECT id, name FROM harbors LIMIT $1</code> with prepared statements.
                        </li>
                        <li style="margin-bottom: 0.5rem;"><strong>Same Hardware:</strong> Apple M3 Pro, localhost
                            PostgreSQL 18.</li>
                    </ul>
                </div>

                <div
                    style="background: var(--surface-2); border-left: 4px solid #22c55e; border-radius: 4px; padding: 1rem; margin: 2rem 0; text-align: left;">
                    <h4 style="color: #22c55e; margin: 0 0 0.5rem;">‚úÖ Honest Disclaimers</h4>
                    <ul style="margin: 0; padding-left: 1.2rem; opacity: 0.9; font-size: 0.95rem;">
                        <li style="margin-bottom: 0.5rem;"><strong>QAIL is ~60% production ready.</strong> We have:
                            speed, SSL/TLS, SCRAM-SHA-256 auth, connection pooling, AST-native migrations, JSON/JSONB,
                            UUID, timestamps.
                            Still missing: Arrays, COPY protocol, full ORM-style mapping.
                        </li>
                        <li style="margin-bottom: 0.5rem;"><strong>Go pgx uses pgx.Batch</strong> for fair comparison
                            (not sequential queries).</li>
                        <li style="margin-bottom: 0.5rem;"><strong>C libpq uses PQenterPipelineMode</strong> + pthreads
                            for fair concurrency.</li>
                    </ul>
                </div>

                <!-- Methodology Section -->
                <div
                    style="margin-top: 2rem; background: var(--surface-2); border-radius: 12px; padding: 1.5rem; text-align: left;">
                    <h4 style="color: var(--primary); margin: 0 0 1rem;">üìä Benchmark Methodology (Reproducible)</h4>
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; font-size: 0.9rem;">
                        <div>
                            <strong>Test Parameters:</strong>
                            <ul style="margin: 0.5rem 0; padding-left: 1.2rem; opacity: 0.9;">
                                <li>50 million queries total</li>
                                <li>10,000 queries per batch</li>
                                <li>Prepared statement: <code>SELECT id, name FROM harbors LIMIT $1</code></li>
                                <li>PostgreSQL 18 pipelining</li>
                            </ul>
                        </div>
                        <div>
                            <strong>Fair Comparison:</strong>
                            <ul style="margin: 0.5rem 0; padding-left: 1.2rem; opacity: 0.9;">
                                <li>‚úÖ Same SQL query</li>
                                <li>‚úÖ Same prepared statements</li>
                                <li>‚úÖ Same pre-built parameters</li>
                                <li>‚úÖ Same database & machine</li>
                            </ul>
                        </div>
                        <div>
                            <strong>Source Code:</strong>
                            <ul style="margin: 0.5rem 0; padding-left: 1.2rem; opacity: 0.9;">
                                <li><a href="https://github.com/qail-rs/qail/blob/main/qail-bench/src/bin/fifty_million_benchmark.rs"
                                        target="_blank" style="color: var(--primary);">QAIL (Rust)</a></li>
                                <li><a href="https://github.com/qail-rs/qail/blob/main/qail-bench/benchmarks/fifty_million_libpq.c"
                                        target="_blank" style="color: var(--primary);">C libpq</a></li>
                                <li><a href="https://github.com/qail-rs/qail/blob/main/qail-bench/benchmarks/fifty_million_pgx.go"
                                        target="_blank" style="color: var(--primary);">Go pgx</a></li>
                            </ul>
                        </div>
                    </div>
                    <p style="margin: 1rem 0 0; font-size: 0.85rem; opacity: 0.8;">
                        Run the benchmarks yourself: <code>cargo run --release --example fifty_million</code>
                    </p>
                </div>
            </section>

            <section style="text-align: center; padding: 3rem 0;">
                <h2 style="font-size: 2rem; margin-bottom: 1rem; color: var(--text);">This Is Just the Beginning</h2>
                <p style="font-size: 1.25rem; color: var(--text-muted); max-width: 600px; margin: 0 auto 2rem;">
                    We built a production-ready PostgreSQL driver that competes with C and beats Go.
                    Now imagine what's next.
                </p>

                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; max-width: 800px; margin: 0 auto 2rem;">
                    <div
                        style="background: var(--surface); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üåê</div>
                        <div style="font-weight: 600; margin-bottom: 0.25rem;">Multi-Database</div>
                        <div style="font-size: 0.875rem; color: var(--text-muted);">MySQL, SQLite, Oracle</div>
                    </div>
                    <div
                        style="background: var(--surface); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">üîó</div>
                        <div style="font-weight: 600; margin-bottom: 0.25rem;">FFI Bindings</div>
                        <div style="font-size: 0.875rem; color: var(--text-muted);">Go, Python, Node.js</div>
                    </div>
                    <div
                        style="background: var(--surface); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border);">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚ö°</div>
                        <div style="font-weight: 600; margin-bottom: 0.25rem;">io_uring</div>
                        <div style="font-size: 0.875rem; color: var(--text-muted);">Even faster on Linux</div>
                    </div>
                </div>

                <a href="https://github.com/qail-rs/qail" target="_blank" class="btn btn-primary"
                    style="margin-top: 1rem; display: inline-flex; align-items: center; gap: 0.5rem;">
                    <svg height="20" width="20" viewBox="0 0 16 16" fill="currentColor">
                        <path
                            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                        </path>
                    </svg>
                    Star on GitHub
                </a>

                <p style="margin-top: 3rem; color: var(--text-muted);">
                    Built with ü¶Ä in Rust
                </p>
            </section>

        </div>
    </main>

    <!-- Footer -->
    <div id="footer"></div>

    <script src="components.js"></script>
    <script src="script.js"></script>
</body>

</html>